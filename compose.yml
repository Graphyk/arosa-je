services:
  backend:
    build:
      context: .
      dockerfile: docker/backend/Dockerfile
    volumes: ["./backend:/app"]
    command: ["python", "/app/manage.py", "runserver", "--nothreading", "0.0.0.0:8000"]
    ports:
      - "${HOST_FRONTEND_PORT-8000}:8000" # Django BO
    deploy:
      resources:
        limits:
          cpus: '0.2'
          memory: 512M

  frontend:
    build:
      context: .
      dockerfile: docker/frontend/Dockerfile
    volumes: ["./frontend:/app"]
    command: ["npm", "run", "dev" ,"--" ,"--host"]
    ports:
      - '${HOST_FRONTEND_PORT-5173}:5173'
    deploy:
      resources:
        limits:
          cpus: '0.2'
          memory: 512M